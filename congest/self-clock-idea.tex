\begin{frame}
\frametitle{normal packets in flight}
{\fontsize{10}{11}\selectfont
\begin{tabular}{lll}
recv'd & sent & count of packets in flight \\ \hline
--- & data 0-7 & 8 \\
ACK 0 & ~ & 7 \\
~ & data 8 & 8 \\
ACK 1 & ~ & 7 \\
~ & data 9 & 8 \\
ACK 2 & ~  & 7 \\
~ & data 10 & 8 \\
ACK 3 & ~  & 7 \\
~ & data 11 & 8 \\
ACK 4 & ~  & 7 \\
~ & data 12 & 8 \\
\end{tabular}
}
\begin{itemize}
\item window size $\sim$ packets in flight normally
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{duplicate ACK waste}
\begin{itemize}
\item window size $\sim$ packets in flight normally
\item but duplicate ACKs are exception (say window size 8)
\end{itemize}
{\fontsize{10}{11}\selectfont
\begin{tabular}{lll}
recv'd & sent & count of packets in flight \\ \hline
--- & data 0-7 & 8 \\
ACK 0 & ~ & 7 \\
~ & data 8 & 8 \\
ACK 1 & ~ & 7 \\
~ & data 9 & 8 \\
ACK 1 & ~  & 7 \\
ACK 1 & ~  & 6 \\
~ & data 2 & 5 \\
ACK 1 & ~ & 4 \\
ACK 1 & ~ & 3 \\
ACK 1 & ~ & 2 \\
\end{tabular}
}
\begin{itemize}
\item problem: need to wait until ACK of 2 to make progress
\end{itemize}
\end{frame}

\begin{frame}{alternate explanation}
    \begin{itemize}
    \item sender stopped sending while receiving duplicate ACKs
    \item but we know \textit{most messages got there}
    \item means our usage of network doesn't reflect our window size
    \vspace{.5cm}
    \item want to transmit new packets in response to these ACKs
        \begin{itemize}
        \item even though out of `normal' window
        \end{itemize}
    \end{itemize}
\end{frame}


\begin{frame}{TCP's fast recovery}
\begin{itemize}
\item estimate \textit{packets in flight}
    \begin{itemize}
    \item with no losses, \texttt{cwnd} already does this!
    \item problem: needs adjustment there are losses
    \end{itemize}
\item transmit new packets when packets in flight < cwnd
    \begin{itemize}
    \item two implementation ideas:
    \item temporarily `inflate' cwnd
    \item track effective send window separately
    \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{fast recovery example}
{\fontsize{9}{10}\selectfont
\begin{tabular}{lllll}
recv'd & sent & est. packets in flight & send window size (range) & cwnd = target packets in flight\\ \hline
--- & data 0-7 & 8 & 8 (0-7) & 8\\
ACK 0 & ~ & 5 & 8 (0-7) & 8 \\
~ & data 8 & 6 & 8 (1-8) & 8\\
ACK 1 & ~ & 5  & 8 (1-8) & 8\\
~ & data 9 & 6 & 8 (2-9) & 8\\
ACK 1 & ~  & 5 & 8 (2-9) & 8\\
ACK 1 & ~  & 4 & 8 (2-9) & 8\\
ACK 1 & ~ & 3 &  8 (2-9) & 4 \\
~ & data 2 & 4 & 8 (2-9) & 4\\
ACK 1 & ~ & 3 &  8 (2-9) & 4 \\
~ & data 10 & 4 & 9 (2-10) & 4\\
ACK 1 & ~ & 3 &  9 (2-10) & 4 \\
~ & data 11 & 4 &  10 (2-11) & 4 \\
\end{tabular}
}
\begin{itemize}
    \item during recovery, ``inflate'' effective send window size
    \item try to make actual packets in flight match new congestion window size
\end{itemize}
\end{frame}

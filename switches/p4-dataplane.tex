\begin{frame}{P4}
    \begin{itemize}
    \item P4 --- programming langauge for data planes
    \item intended to be compiled to run on fast switches
    \item includes `runtime' defining how control plane configures data plane
    \end{itemize}
\end{frame}

\begin{frame}{future P4 assignment}
    \begin{itemize}
    \item given: 
        \begin{itemize}
        \item simple P4 switch that doesn't know where to direct frames
        \item simpler controller (in Python) that configures switch
        \item simulated 4-machine network in VM
        \end{itemize}
    \item your task will be:
        \begin{itemize}
        \item have controller write static configuration to direct to right place
        \item modify data plane to send information to control plane
        \item have controller change configuration based on info from data plane
        \end{itemize}
    \item (we'll discuss more details later)
    \end{itemize}
\end{frame}

\begin{frame}{P4 switch architecture}
\begin{tikzpicture}
\foreach \x in {1,2,3,4} {
    \begin{scope}[yshift=\x cm,y=0.9cm]
        \draw[thick] (0, 0) rectangle (2, 1);
        \draw[ultra thick,-Latex] (-1, .5) -- (0, .5);
        \foreach \off in {1,1.2,1.4,1.6,1.8} {
            \draw[thick] (\off, 0) -- (\off, 1);
        }
    \end{scope}
}
\tikzset{
    box/.style={draw,thick},
    box label/.style={font=\small},
};
\foreach \x/\name in {3/parser,5/ingress,7/deparser} {
    \draw[box] (\x, 1) coordinate (\name in base) rectangle ++(1.6, 2) coordinate (name other base) node[midway,box label] (\name label) {\name};
    \draw[box] (\x + 1.4, 1) |- (\x - .2, .8) |- (\x, 1.8); 
    \draw[box] (\x + 1.2, 1) |- (\x - .4, .6) |- (\x, 1.6); 
}
\foreach \x/\name in {11/parser,13/egress,15/deparser} {
    \draw[box] (\x, 1) coordinate (\name out base) rectangle ++(2, 2) coordinate (name other base) node[midway,box label] (\name label) {\name};
    \draw[box] (\x + 1.4, 1) |- (\x - .2, .8) |- (\x, 1.8); 
    \draw[box] (\x + 1.2, 1) |- (\x - .4, .6) |- (\x, 1.6); 
}
\end{tikzpicture}
\end{frame}

% FIXME:
    % example parser + deparser program
        % idea of copying from buffer to control structure
    % example match-pipeline
        % show table lookup
        % show standard_metadata
    
    % example configuration

\begin{frame}[fragile,label=sAddrIn]{sockaddr\_in}
\begin{lstlisting}[
    language=C++,style=smaller,
    moredelim={**[is][\btHL<2|handout:2>]{@2}{2@}},
    moredelim={**[is][\btHL<3|handout:3>]{@3}{3@}},
    moredelim={**[is][\btHL<4|handout:4>]{@4}{4@}},
    moredelim={**[is][\btHL<5|handout:5>]{@5}{5@}},
    moredelim={**[is][\btHL<6|handout:6>]{@6}{6@}},
]
/* from 'man 7 ip' */
struct sockaddr_in {
   @3sa_family_t    sin_family3@; /* address family: always AF_INET */
   @2in_port_t      sin_port2@;   /* port in network byte order */
   @2struct in_addr sin_addr2@;   /* internet address */
};

/* Internet address. */
struct in_addr {
   @2uint32_t       s_addr2@;     /* address in network byte order */
};
\end{lstlisting}
\begin{tikzpicture}[overlay,remember picture]
\begin{visibleenv}<3>
\node[draw=red,very thick,align=center,anchor=south] at ([yshift=1cm]current page.south) {
    trick: multiple versions of address struct \\
    each have ``type'' information in same spot \\
    OS/library checks before using
};
\end{visibleenv}
\end{tikzpicture}
\end{frame}

\begin{frame}[fragile,label=sAddrIn6]{sockaddr\_in6}
\begin{lstlisting}[
    language=C++,style=smaller,
    moredelim={**[is][\btHL<2|handout:2>]{@2}{2@}},
    moredelim={**[is][\btHL<3|handout:3>]{@3}{3@}},
    moredelim={**[is][\btHL<4|handout:4>]{@4}{4@}},
    moredelim={**[is][\btHL<5|handout:5>]{@5}{5@}},
    moredelim={**[is][\btHL<6|handout:6>]{@6}{6@}},
]
/* from 'man 7 ipv6' */
struct sockaddr_in6 {
   sa_family_t     sin6_family;   /* always AF_INET6 */
   @2in_port_t       sin6_port2@;     /* port number */
   uint32_t        sin6_flowinfo; /* IPv6 flow information */
   @2struct in6_addr sin6_addr2@;     /* IPv6 address */
   uint32_t        sin6_scope_id; /* Scope ID (new in 2.4) */
};

struct in6_addr {
   @2unsigned char   s6_addr[16]2@;   /* IPv6 address */
};
\end{lstlisting}
\end{frame}

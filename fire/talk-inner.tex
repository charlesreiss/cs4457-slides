\section{firewall}

\subsection{iptable model, INPUT v FORWARD v OUTPUT}

\subsection{matching packets}

\subsubsection{not matching text in TCP}

\section{stateful firewalls}

\subsection{connection tracking}

\subsubsection{what about UDP}

\subsubsection{PING/PONG; TCP keepalive}

\subsubsection{extra connections in FTP, IRC, etc}

\section{IDSes}

\subsection{snort}

\section{network address translation}

\subsection{motivation: missing addresses}

\subsection{reusing connection tracking}

\section{NAT traversal}

\subsection{discovering external addresses}

\subsection{via connection state manipulation}

\subsection{UPnP}

\subsection{TURN}
